function fem=single_mode_1(freq)

% COMSOL Multiphysics Model M-file
% Generated by COMSOL 3.4 (COMSOL 3.4.0.248, $Date: 2007/10/10 16:07:51 $)

flclear fem

% COMSOL version
clear vrsn
vrsn.name = 'COMSOL 3.4';
vrsn.ext = '';
vrsn.major = 0;
vrsn.build = 248;
vrsn.rcs = '$Name:  $';
vrsn.date = '$Date: 2007/10/10 16:07:51 $';
fem.version = vrsn;

% Constants
fem.const = {'r1','0.11', ...
  'eps1','15', ...
  'mu1','14', ...
  'kappa1','12.4', ...
  'r2','0.141', ...
  'eps2','9.5', ...
  'freq','0.552*3e8'};

% Geometry
g1=rect2('30','10','base','corner','pos',{'0','0'},'rot','0');
g2=rect2('5','10','base','corner','pos',{'0','0'},'rot','0');
g3=rect2('5','10','base','corner','pos',{'25','0'},'rot','0');
g4=circ2('r1','base','center','pos',{'0.5','0.5'},'rot','0','const',fem.const);
garr=geomarrayr(g4,1,1,30,5);
[g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,g30,g31,g32,g33,g34,g35,g36,g37,g38,g39,g40,g41,g42,g43,g44,g45,g46,g47,g48,g49,g50,g51,g52,g53,g54,g55,g56,g57,g58,g59,g60,g61,g62,g63,g64,g65,g66,g67,g68,g69,g70,g71,g72,g73,g74,g75,g76,g77,g78,g79,g80,g81,g82,g83,g84,g85,g86,g87,g88,g89,g90,g91,g92,g93,g94,g95,g96,g97,g98,g99,g100,g101,g102,g103,g104,g105,g106,g107,g108,g109,g110,g111,g112,g113,g114,g115,g116,g117,g118,g119,g120,g121,g122,g123,g124,g125,g126,g127,g128,g129,g130,g131,g132,g133,g134,g135,g136,g137,g138,g139,g140,g141,g142,g143,g144,g145,g146,g147,g148,g149,g150,g151,g152,g153,g154]=deal(garr{:});
g155=circ2('r2','base','center','pos',{'0.5','5.5'},'rot','0','const',fem.const);
garr=geomarrayr(g155,1,1,30,5);
[g156,g157,g158,g159,g160,g161,g162,g163,g164,g165,g166,g167,g168,g169,g170,g171,g172,g173,g174,g175,g176,g177,g178,g179,g180,g181,g182,g183,g184,g185,g186,g187,g188,g189,g190,g191,g192,g193,g194,g195,g196,g197,g198,g199,g200,g201,g202,g203,g204,g205,g206,g207,g208,g209,g210,g211,g212,g213,g214,g215,g216,g217,g218,g219,g220,g221,g222,g223,g224,g225,g226,g227,g228,g229,g230,g231,g232,g233,g234,g235,g236,g237,g238,g239,g240,g241,g242,g243,g244,g245,g246,g247,g248,g249,g250,g251,g252,g253,g254,g255,g256,g257,g258,g259,g260,g261,g262,g263,g264,g265,g266,g267,g268,g269,g270,g271,g272,g273,g274,g275,g276,g277,g278,g279,g280,g281,g282,g283,g284,g285,g286,g287,g288,g289,g290,g291,g292,g293,g294,g295,g296,g297,g298,g299,g300,g301,g302,g303,g304,g305]=deal(garr{:});
g306=circ2('r2','base','center','pos',{'1','6'},'rot','0','const',fem.const);
garr=geomarrayr(g306,1,1,29,4);
[g307,g308,g309,g310,g311,g312,g313,g314,g315,g316,g317,g318,g319,g320,g321,g322,g323,g324,g325,g326,g327,g328,g329,g330,g331,g332,g333,g334,g335,g336,g337,g338,g339,g340,g341,g342,g343,g344,g345,g346,g347,g348,g349,g350,g351,g352,g353,g354,g355,g356,g357,g358,g359,g360,g361,g362,g363,g364,g365,g366,g367,g368,g369,g370,g371,g372,g373,g374,g375,g376,g377,g378,g379,g380,g381,g382,g383,g384,g385,g386,g387,g388,g389,g390,g391,g392,g393,g394,g395,g396,g397,g398,g399,g400,g401,g402,g403,g404,g405,g406,g407,g408,g409,g410,g411,g412,g413,g414,g415,g416,g417,g418,g419,g420,g421,g422]=deal(garr{:});
parr={point2(7.5,5)};
g423=geomcoerce('point',parr);

% Analyzed geometry
clear p s
p.objs={g423};
p.name={'PT1'};
p.tags={'g423'};

s.objs={g1,g2,g3,g4,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18, ...
  g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,g30,g31,g32,g33,g34,g35, ...
  g36,g37,g38,g39,g40,g41,g42,g43,g44,g45,g46,g47,g48,g49,g50,g51,g52, ...
  g53,g54,g55,g56,g57,g58,g59,g60,g61,g62,g63,g64,g65,g66,g67,g68,g69, ...
  g70,g71,g72,g73,g74,g75,g76,g77,g78,g79,g80,g81,g82,g83,g84,g85,g86, ...
  g87,g88,g89,g90,g91,g92,g93,g94,g95,g96,g97,g98,g99,g100,g101,g102, ...
  g103,g104,g105,g106,g107,g108,g109,g110,g111,g112,g113,g114,g115,g116, ...
  g117,g118,g119,g120,g121,g122,g123,g124,g125,g126,g127,g128,g129,g130, ...
  g131,g132,g133,g134,g135,g136,g137,g138,g139,g140,g141,g142,g143,g144, ...
  g145,g146,g147,g148,g149,g150,g151,g152,g153,g154,g155,g157,g158,g159, ...
  g160,g161,g162,g163,g164,g165,g166,g167,g168,g169,g170,g171,g172,g173, ...
  g174,g175,g176,g177,g178,g179,g180,g181,g182,g183,g184,g185,g186,g187, ...
  g188,g189,g190,g191,g192,g193,g194,g195,g196,g197,g198,g199,g200,g201, ...
  g202,g203,g204,g205,g206,g207,g208,g209,g210,g211,g212,g213,g214,g215, ...
  g216,g217,g218,g219,g220,g221,g222,g223,g224,g225,g226,g228,g229,g230, ...
  g231,g232,g233,g234,g235,g236,g237,g238,g239,g240,g241,g242,g243,g244, ...
  g245,g246,g247,g248,g249,g250,g251,g252,g253,g254,g255,g256,g257,g258, ...
  g259,g260,g261,g262,g263,g264,g265,g266,g267,g268,g269,g270,g271,g272, ...
  g273,g274,g275,g276,g277,g278,g279,g280,g281,g282,g283,g284,g285,g286, ...
  g287,g288,g289,g290,g291,g292,g293,g294,g295,g296,g297,g298,g299,g300, ...
  g301,g302,g303,g304,g305,g306,g308,g309,g310,g311,g312,g313,g314,g315, ...
  g316,g317,g318,g319,g320,g321,g322,g323,g324,g325,g326,g327,g328,g329, ...
  g330,g331,g332,g333,g334,g335,g336,g337,g338,g339,g340,g341,g342,g343, ...
  g344,g345,g346,g347,g348,g349,g350,g351,g352,g353,g354,g355,g356,g357, ...
  g358,g359,g360,g361,g362,g363,g364,g365,g366,g367,g368,g369,g370,g371, ...
  g372,g373,g374,g375,g376,g377,g378,g379,g380,g381,g382,g383,g384,g385, ...
  g386,g387,g388,g389,g390,g391,g392,g393,g394,g395,g396,g397,g398,g399, ...
  g400,g401,g402,g403,g404,g405,g406,g407,g408,g409,g410,g411,g412,g413, ...
  g414,g415,g416,g417,g418,g419,g420,g421,g422};
s.name={'R1','R2','R3','C1','C2','C3','C4','C5','C6','C7','C8','C9', ...
  'C10','C11','C12','C13','C14','C15','C16','C17','C18','C19','C20','C21', ...
  'C22','C23','C24','C25','C26','C27','C28','C29','C30','C31','C32','C33', ...
  'C34','C35','C36','C37','C38','C39','C40','C41','C42','C43','C44','C45', ...
  'C46','C47','C48','C49','C50','C51','C52','C53','C54','C55','C56','C57', ...
  'C58','C59','C60','C61','C62','C63','C64','C65','C66','C67','C68','C69', ...
  'C70','C71','C72','C73','C74','C75','C76','C77','C78','C79','C80','C81', ...
  'C82','C83','C84','C85','C86','C87','C88','C89','C90','C91','C92','C93', ...
  'C94','C95','C96','C97','C98','C99','C100','C101','C102','C103','C104', ...
  'C105','C106','C107','C108','C109','C110','C111','C112','C113','C114', ...
  'C115','C116','C117','C118','C119','C120','C121','C122','C123','C124', ...
  'C125','C126','C127','C128','C129','C130','C131','C132','C133','C134', ...
  'C135','C136','C137','C138','C139','C140','C141','C142','C143','C144', ...
  'C145','C146','C147','C148','C149','C150','C151','C152','C153','C154', ...
  'C155','C156','C157','C158','C159','C160','C161','C162','C163','C164', ...
  'C165','C166','C167','C168','C169','C170','C171','C172','C173','C174', ...
  'C175','C176','C177','C178','C179','C180','C181','C182','C183','C184', ...
  'C185','C186','C187','C188','C189','C190','C191','C192','C193','C194', ...
  'C195','C196','C197','C198','C199','C200','C201','C202','C203','C204', ...
  'C205','C206','C207','C208','C209','C210','C211','C212','C213','C214', ...
  'C215','C216','C217','C218','C219','C220','C221','C223','C224','C225', ...
  'C226','C227','C228','C229','C230','C231','C232','C233','C234','C235', ...
  'C236','C237','C238','C239','C240','C241','C242','C243','C244','C245', ...
  'C246','C247','C248','C249','C250','C251','C252','C253','C254','C255', ...
  'C256','C257','C258','C259','C260','C261','C262','C263','C264','C265', ...
  'C266','C267','C268','C269','C270','C271','C272','C273','C274','C275', ...
  'C276','C277','C278','C279','C280','C281','C282','C283','C284','C285', ...
  'C286','C287','C288','C289','C290','C291','C292','C293','C294','C295', ...
  'C296','C297','C298','C299','C300','C301','C302','C303','C304','C305', ...
  'C306','C307','C308','C309','C310','C311','C312','C313','C314','C315', ...
  'C316','C317','C318','C319','C320','C321','C322','C323','C324','C325', ...
  'C326','C327','C328','C329','C330','C331','C332','C333','C334','C335', ...
  'C336','C337','C338','C339','C340','C341','C342','C343','C344','C345', ...
  'C346','C347','C348','C349','C350','C351','C352','C353','C354','C355', ...
  'C356','C357','C358','C359','C360','C361','C362','C363','C364','C365', ...
  'C366','C367','C368','C369','C370','C371','C372','C373','C374','C375', ...
  'C376','C377','C378','C379','C380','C381','C382','C383','C384','C385', ...
  'C386','C387','C388','C389','C390','C391','C392','C393','C394','C395', ...
  'C396','C397','C398','C399','C400','C401','C402','C403','C404','C405', ...
  'C406','C407','C408','C409','C410','C411','C412','C413','C414','C415', ...
  'C416'};
s.tags={'g1','g2','g3','g4','g6','g7','g8','g9','g10','g11','g12', ...
  'g13','g14','g15','g16','g17','g18','g19','g20','g21','g22','g23','g24', ...
  'g25','g26','g27','g28','g29','g30','g31','g32','g33','g34','g35','g36', ...
  'g37','g38','g39','g40','g41','g42','g43','g44','g45','g46','g47','g48', ...
  'g49','g50','g51','g52','g53','g54','g55','g56','g57','g58','g59','g60', ...
  'g61','g62','g63','g64','g65','g66','g67','g68','g69','g70','g71','g72', ...
  'g73','g74','g75','g76','g77','g78','g79','g80','g81','g82','g83','g84', ...
  'g85','g86','g87','g88','g89','g90','g91','g92','g93','g94','g95','g96', ...
  'g97','g98','g99','g100','g101','g102','g103','g104','g105','g106', ...
  'g107','g108','g109','g110','g111','g112','g113','g114','g115','g116', ...
  'g117','g118','g119','g120','g121','g122','g123','g124','g125','g126', ...
  'g127','g128','g129','g130','g131','g132','g133','g134','g135','g136', ...
  'g137','g138','g139','g140','g141','g142','g143','g144','g145','g146', ...
  'g147','g148','g149','g150','g151','g152','g153','g154','g155','g157', ...
  'g158','g159','g160','g161','g162','g163','g164','g165','g166','g167', ...
  'g168','g169','g170','g171','g172','g173','g174','g175','g176','g177', ...
  'g178','g179','g180','g181','g182','g183','g184','g185','g186','g187', ...
  'g188','g189','g190','g191','g192','g193','g194','g195','g196','g197', ...
  'g198','g199','g200','g201','g202','g203','g204','g205','g206','g207', ...
  'g208','g209','g210','g211','g212','g213','g214','g215','g216','g217', ...
  'g218','g219','g220','g221','g222','g223','g224','g225','g226','g228', ...
  'g229','g230','g231','g232','g233','g234','g235','g236','g237','g238', ...
  'g239','g240','g241','g242','g243','g244','g245','g246','g247','g248', ...
  'g249','g250','g251','g252','g253','g254','g255','g256','g257','g258', ...
  'g259','g260','g261','g262','g263','g264','g265','g266','g267','g268', ...
  'g269','g270','g271','g272','g273','g274','g275','g276','g277','g278', ...
  'g279','g280','g281','g282','g283','g284','g285','g286','g287','g288', ...
  'g289','g290','g291','g292','g293','g294','g295','g296','g297','g298', ...
  'g299','g300','g301','g302','g303','g304','g305','g306','g308','g309', ...
  'g310','g311','g312','g313','g314','g315','g316','g317','g318','g319', ...
  'g320','g321','g322','g323','g324','g325','g326','g327','g328','g329', ...
  'g330','g331','g332','g333','g334','g335','g336','g337','g338','g339', ...
  'g340','g341','g342','g343','g344','g345','g346','g347','g348','g349', ...
  'g350','g351','g352','g353','g354','g355','g356','g357','g358','g359', ...
  'g360','g361','g362','g363','g364','g365','g366','g367','g368','g369', ...
  'g370','g371','g372','g373','g374','g375','g376','g377','g378','g379', ...
  'g380','g381','g382','g383','g384','g385','g386','g387','g388','g389', ...
  'g390','g391','g392','g393','g394','g395','g396','g397','g398','g399', ...
  'g400','g401','g402','g403','g404','g405','g406','g407','g408','g409', ...
  'g410','g411','g412','g413','g414','g415','g416','g417','g418','g419', ...
  'g420','g421','g422'};

fem.draw=struct('p',p,'s',s);
fem.geom=geomcsg(fem);

% Initialize mesh
fem.mesh=meshinit(fem, ...
                  'hauto',10);   %change to 5

% (Default values are not included)

% Application mode 1
clear appl
appl.mode.class = 'InPlaneWaves';
appl.module = 'RF';
appl.assignsuffix = '_rfwe';
clear pnt
pnt.I0 = {0,1};
pnt.ind = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, ...
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];
appl.pnt = pnt;
clear bnd
bnd.type = {'E0','cont'};
bnd.ind = [1,1,1,2,1,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,1,1,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2, ...
  2,2,2,2,2,2,2,2,2,2,2];
appl.bnd = bnd;
clear equ
equ.epsilonr = {1,1,{1;1;'eps2'},1,{1;1;'eps1'}};
equ.Stype = {'coord','none','none','coord','none'};
equ.mur = {1,1,1,1,{'mu1','i*kappa1',0;'-i*kappa1','mu1',0;0, ...
  0,1}};
equ.coordOn = {{1;0},{0;0},{0;0},{1;0},{0;0}};
equ.srcpnt = {{2.5;5},{0;0},{0;0},{27.5;5},{0;0}};
equ.Sd = {{5;'Sdy_guess_rfwe'},{'Sdx_guess_rfwe';'Sdy_guess_rfwe'},{'Sdx_guess_rfwe'; ...
  'Sdy_guess_rfwe'},{5;'Sdy_guess_rfwe'},{'Sdx_guess_rfwe';'Sdy_guess_rfwe'}};
equ.ind = [1,2,3,3,3,3,3,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3, ...
  3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3, ...
  3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3, ...
  3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5, ...
  5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3, ...
  3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5, ...
  5,5,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3, ...
  3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5, ...
  5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3, ...
  3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5, ...
  5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5, ...
  5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3, ...
  3,3,3,3,3,3,5,5,5,5,5];

appl.equ = equ;
appl.var = {'nu','freq'};
fem.appl{1} = appl;
fem.frame = {'ref'};
fem.border = 1;
clear units;
units.basesystem = 'SI';
fem.units = units;

% ODE Settings
clear ode
clear units;
units.basesystem = 'SI';
ode.units = units;
fem.ode=ode;
% Multiphysics
fem=multiphysics(fem);

% Extend mesh
fem.xmesh=meshextend(fem);

% Solve problem
fem.sol=femstatic(fem, ...
                  'complexfun','on', ...
                  'solcomp',{'Ez'}, ...
                  'outcomp',{'Ez'}, ...
                  'pname','freq', ...
                  'plist',freq*3e8, ...
                  'oldcomp',{});

% Plot solution
postplot(fem, ...
         'tridata',{'Ez','cont','internal','unit','V/m'}, ...
         'tridlim',[-2500 2500], ...
         'trimap','wavemap(1024)', ...
         'title','freq', ...
         'axis',[-1.5,31.575,-5.523863636363636,15.523863636363636]);
